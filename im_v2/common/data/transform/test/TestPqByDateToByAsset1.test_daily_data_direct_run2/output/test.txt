# by_date=
# Dir structure
$GIT_ROOT/im_v2/common/data/transform/test/TestPqByDateToByAsset1.test_daily_data_direct_run2/tmp.scratch/by_date
$GIT_ROOT/im_v2/common/data/transform/test/TestPqByDateToByAsset1.test_daily_data_direct_run2/tmp.scratch/by_date/date=20211230
$GIT_ROOT/im_v2/common/data/transform/test/TestPqByDateToByAsset1.test_daily_data_direct_run2/tmp.scratch/by_date/date=20211230/data.parquet
$GIT_ROOT/im_v2/common/data/transform/test/TestPqByDateToByAsset1.test_daily_data_direct_run2/tmp.scratch/by_date/date=20211231
$GIT_ROOT/im_v2/common/data/transform/test/TestPqByDateToByAsset1.test_daily_data_direct_run2/tmp.scratch/by_date/date=20211231/data.parquet
$GIT_ROOT/im_v2/common/data/transform/test/TestPqByDateToByAsset1.test_daily_data_direct_run2/tmp.scratch/by_date/date=20220101
$GIT_ROOT/im_v2/common/data/transform/test/TestPqByDateToByAsset1.test_daily_data_direct_run2/tmp.scratch/by_date/date=20220101/data.parquet
# File signatures
len(file_names)=3
file_names=$GIT_ROOT/im_v2/common/data/transform/test/TestPqByDateToByAsset1.test_daily_data_direct_run2/tmp.scratch/by_date/date=20211230/data.parquet, $GIT_ROOT/im_v2/common/data/transform/test/TestPqByDateToByAsset1.test_daily_data_direct_run2/tmp.scratch/by_date/date=20211231/data.parquet, $GIT_ROOT/im_v2/common/data/transform/test/TestPqByDateToByAsset1.test_daily_data_direct_run2/tmp.scratch/by_date/date=20220101/data.parquet
# $GIT_ROOT/im_v2/common/data/transform/test/TestPqByDateToByAsset1.test_daily_data_direct_run2/tmp.scratch/by_date/date=20211230/data.parquet
num_lines=61
'''
original shape=(72, 7)
Head:
{
    "2021-12-30T00:00:00Z":{
        "interval":3600,
        "start_time":1640822400,
        "end_time":1640826000,
        "ticker":"A",
        "currency":"USD",
        "open":0,
        "id":0
    },
    "2021-12-30T01:00:00Z":{
        "interval":3600,
        "start_time":1640826000,
        "end_time":1640829600,
        "ticker":"A",
        "currency":"USD",
        "open":1,
        "id":0
    },
    "2021-12-30T02:00:00Z":{
        "interval":3600,
        "start_time":1640829600,
        "end_time":1640833200,
        "ticker":"A",
        "currency":"USD",
        "open":2,
        "id":0
    }
}
Tail:
{
    "2021-12-30T21:00:00Z":{
        "interval":3600,
        "start_time":1640898000,
        "end_time":1640901600,
        "ticker":"C",
        "currency":"USD",
        "open":21,
        "id":2
    },
    "2021-12-30T22:00:00Z":{
        "interval":3600,
        "start_time":1640901600,
        "end_time":1640905200,
        "ticker":"C",
        "currency":"USD",
        "open":22,
        "id":2
    },
    "2021-12-30T23:00:00Z":{
        "interval":3600,
        "start_time":1640905200,
        "end_time":1640908800,
        "ticker":"C",
        "currency":"USD",
        "open":23,
        "id":2
    }
}
'''
# $GIT_ROOT/im_v2/common/data/transform/test/TestPqByDateToByAsset1.test_daily_data_direct_run2/tmp.scratch/by_date/date=20211231/data.parquet
num_lines=61
'''
original shape=(72, 7)
Head:
{
    "2021-12-31T00:00:00Z":{
        "interval":3600,
        "start_time":1640908800,
        "end_time":1640912400,
        "ticker":"A",
        "currency":"USD",
        "open":24,
        "id":0
    },
    "2021-12-31T01:00:00Z":{
        "interval":3600,
        "start_time":1640912400,
        "end_time":1640916000,
        "ticker":"A",
        "currency":"USD",
        "open":25,
        "id":0
    },
    "2021-12-31T02:00:00Z":{
        "interval":3600,
        "start_time":1640916000,
        "end_time":1640919600,
        "ticker":"A",
        "currency":"USD",
        "open":26,
        "id":0
    }
}
Tail:
{
    "2021-12-31T21:00:00Z":{
        "interval":3600,
        "start_time":1640984400,
        "end_time":1640988000,
        "ticker":"C",
        "currency":"USD",
        "open":45,
        "id":2
    },
    "2021-12-31T22:00:00Z":{
        "interval":3600,
        "start_time":1640988000,
        "end_time":1640991600,
        "ticker":"C",
        "currency":"USD",
        "open":46,
        "id":2
    },
    "2021-12-31T23:00:00Z":{
        "interval":3600,
        "start_time":1640991600,
        "end_time":1640995200,
        "ticker":"C",
        "currency":"USD",
        "open":47,
        "id":2
    }
}
'''
# $GIT_ROOT/im_v2/common/data/transform/test/TestPqByDateToByAsset1.test_daily_data_direct_run2/tmp.scratch/by_date/date=20220101/data.parquet
num_lines=61
'''
original shape=(72, 7)
Head:
{
    "2022-01-01T00:00:00Z":{
        "interval":3600,
        "start_time":1640995200,
        "end_time":1640998800,
        "ticker":"A",
        "currency":"USD",
        "open":48,
        "id":0
    },
    "2022-01-01T01:00:00Z":{
        "interval":3600,
        "start_time":1640998800,
        "end_time":1641002400,
        "ticker":"A",
        "currency":"USD",
        "open":49,
        "id":0
    },
    "2022-01-01T02:00:00Z":{
        "interval":3600,
        "start_time":1641002400,
        "end_time":1641006000,
        "ticker":"A",
        "currency":"USD",
        "open":50,
        "id":0
    }
}
Tail:
{
    "2022-01-01T21:00:00Z":{
        "interval":3600,
        "start_time":1641070800,
        "end_time":1641074400,
        "ticker":"C",
        "currency":"USD",
        "open":69,
        "id":2
    },
    "2022-01-01T22:00:00Z":{
        "interval":3600,
        "start_time":1641074400,
        "end_time":1641078000,
        "ticker":"C",
        "currency":"USD",
        "open":70,
        "id":2
    },
    "2022-01-01T23:00:00Z":{
        "interval":3600,
        "start_time":1641078000,
        "end_time":1641081600,
        "ticker":"C",
        "currency":"USD",
        "open":71,
        "id":2
    }
}
'''
# by_asset=
# Dir structure
$GIT_ROOT/im_v2/common/data/transform/test/TestPqByDateToByAsset1.test_daily_data_direct_run2/tmp.scratch/by_asset
# File signatures
len(file_names)=0
file_names=