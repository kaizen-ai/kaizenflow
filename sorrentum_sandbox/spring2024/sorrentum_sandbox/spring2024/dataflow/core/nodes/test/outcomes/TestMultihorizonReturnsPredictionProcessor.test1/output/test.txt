################################################################################
config
################################################################################
target_col: ret_0_zscored
prediction_cols: ['ret_0_zscored.shift_-1_hat', 'ret_0_zscored.shift_-2_hat', 'ret_0_zscored.shift_-3_hat']
volatility_col: vol.shift_-1_hat
################################################################################
df_in
################################################################################
               ret_0  vol.shift_-1_hat  ret_0_zscored  ret_0_zscored.shift_-3  ret_0_zscored.shift_-1_hat  ret_0_zscored.shift_-2_hat  ret_0_zscored.shift_-3_hat
2010-01-01  0.049671   0.049671            NaN         3.827786                  NaN                  NaN                  NaN
2010-01-02  0.085516   0.068154       1.721642         2.943468             1.721642             1.721642             1.721642
2010-01-03  0.136459   0.092359       2.002219         1.847281             1.896290             1.885098             1.879376
2010-01-04  0.353531   0.163895       3.827786         2.076788             2.874555             2.756278             2.696206
2010-01-05  0.482418   0.235800       2.943468         2.475820             2.905914             2.828335             2.782731
2010-01-06  0.435589   0.274509       1.847281         2.092067             2.452125             2.485480             2.492721
2010-01-07  0.570097   0.325048       2.076788         1.829085             2.296704             2.351496             2.374292
2010-01-08  0.804762   0.398915       2.475820         1.666188             2.369375             2.390522             2.401473
2010-01-09  0.834558   0.460266       2.092067         1.372576             2.258227             2.299602             2.322321
2010-01-10  0.841866   0.510015       1.829085         1.277348             2.087476             2.159237             2.200363
2010-01-11  0.849780   0.551420       1.666188         0.957757             1.920588             2.014303             2.071638
2010-01-12  0.756866   0.575011       1.372576         0.345107             1.704077             1.827621             1.906445
2010-01-13  0.734489   0.592381       1.277348        -0.045678             1.535755             1.668726             1.759998
2010-01-14  0.567357   0.589781       0.957757        -0.368291             1.307988             1.464508             1.575385
2010-01-15  0.203537   0.551317       0.345107        -0.582968             0.928778             1.144181             1.294775
2010-01-16 -0.025183   0.496061      -0.045678        -0.839206             0.545147             0.804605             0.991126
2010-01-17 -0.182695   0.433220      -0.368291        -1.742895             0.185617             0.470513             0.684814
2010-01-18 -0.252553   0.371698      -0.582968        -2.249819            -0.116859             0.170847             0.400324
2010-01-19 -0.311931   0.312104      -0.839206        -2.370582            -0.401116            -0.116183             0.123060
2010-01-20 -0.543964   0.239410      -1.742895        -3.386708            -0.929104            -0.578125            -0.293290
2010-01-21 -0.538629   0.174912      -2.249819        -6.838036            -1.448789            -1.052602            -0.729008
2010-01-22 -0.414642   0.127105      -2.370582       -23.708944            -1.811496            -1.426549            -1.094039
2010-01-23 -0.430467   0.082800      -3.386708        28.024762            -2.431304            -1.982556            -1.603256
2010-01-24 -0.566189   0.032186      -6.838036        10.411661            -4.165235            -3.359577            -2.764882
2010-01-25 -0.763102  -0.028776     -23.708944         6.647425           -11.855133            -9.129921            -7.409205
2010-01-26 -0.806448  -0.087446      28.024762         4.807761             3.836442             1.404800             0.443921
2010-01-27 -0.910455  -0.148627      10.411661         4.101504             6.423595             3.958403             2.652097
2010-01-28 -0.987985  -0.210177       6.647425         3.629213             6.511665             4.720751             3.536897
2010-01-29 -1.010479  -0.268124       4.807761         2.737961             5.841231             4.745418             3.818267
2010-01-30 -1.099712  -0.327634       4.101504         2.018928             5.156701             4.562877             3.880964
2010-01-31 -1.189052  -0.388609       3.629213         2.115067             4.555681             4.298200             3.825246
2010-02-01 -1.063995  -0.435933       2.737961         2.011150             3.840464             3.855907             3.584636
2010-02-02 -0.880117  -0.466764       2.018928         1.955466             3.123745             3.335169             3.238186
2010-02-03 -0.987238  -0.502575       2.115067         2.013533             2.726861             2.989302             2.989688
2010-02-04 -1.010754  -0.537255       2.011150         2.171601             2.445251             2.712023             2.773192
2010-02-05 -1.050584  -0.572020       1.955466         2.513028             2.252535             2.497561             2.592283
2010-02-06 -1.151782  -0.611007       2.013533         2.439688             2.158495             2.360354             2.464248
2010-02-07 -1.326863  -0.658826       2.171601         2.110157             2.163652             2.306848             2.399509
2010-02-08 -1.655648  -0.725003       2.513028         1.859995             2.301121             2.365294             2.424621
2010-02-09 -1.768781  -0.793897       2.439688         1.754875             2.355643             2.386382             2.427954
2010-02-10 -1.675248  -0.851757       2.110157         1.716942             2.259052             2.308081             2.357654
2010-02-11 -1.584265  -0.899604       1.859995         1.821010             2.102035             2.181062             2.247569
2010-02-12 -1.578693  -0.943752       1.754875         1.940905             1.965438             2.060252             2.138582
2010-02-13 -1.620368  -0.987546       1.716942         1.937387             1.867663             1.962934             2.045314
2010-02-14 -1.798330  -1.039807       1.821010         1.776736             1.849306             1.922703             1.995697
2010-02-15 -2.018167  -1.102627       1.940905         1.578701             1.885348             1.927863             1.983577
2010-02-16 -2.136215  -1.168754       1.937387         1.634304             1.905823             1.930562             1.973360
2010-02-17 -2.076567  -1.226637       1.776736              NaN             1.855032             1.886958             1.929866
2010-02-18 -1.936493  -1.271755       1.578701              NaN             1.746304             1.799576             1.852188
2010-02-19 -2.078435  -1.322876       1.634304              NaN             1.702235             1.752727             1.803992
################################################################################
df_out
################################################################################
            cumret.shift_-1  cumret.shift_-2  cumret.shift_-3  cumret.shift_-1_hat  cumret.shift_-2_hat  cumret.shift_-3_hat
2010-01-01  0.353531  0.489989  0.575506           NaN           NaN           NaN
2010-01-02  0.482418  0.835949  0.972408      0.117336      0.234673      0.352009
2010-01-03  0.435589  0.918008  1.271538      0.175140      0.349245      0.522823
2010-01-04  0.570097  1.005686  1.488104      0.471124      0.922863      1.364756
2010-01-05  0.804762  1.374858  1.810448      0.685215      1.352137      2.008306
2010-01-06  0.834558  1.639319  2.209416      0.673130      1.355416      2.039690
2010-01-07  0.841866  1.676424  2.481185      0.746540      1.510890      2.282650
2010-01-08  0.849780  1.691647  2.526204      0.945180      1.898796      2.856781
2010-01-09  0.756866  1.606646  2.448512      1.039386      2.097815      3.166701
2010-01-10  0.734489  1.491355  2.341135      1.064643      2.165886      3.288103
2010-01-11  0.567357  1.301846  2.058712      1.059050      2.169777      3.312119
2010-01-12  0.203537  0.770895  1.505383      0.979863      2.030765      3.126991
2010-01-13 -0.025183  0.178354  0.745711      0.909752      1.898274      2.940864
2010-01-14 -0.182695 -0.207878 -0.004341      0.771427      1.635166      2.564299
2010-01-15 -0.252553 -0.435248 -0.460432      0.512051      1.142858      1.856689
2010-01-16 -0.311931 -0.564485 -0.747180      0.270426      0.669560      1.161219
2010-01-17 -0.543964 -0.855895 -1.108448      0.080413      0.284248      0.580924
2010-01-18 -0.538629 -1.082593 -1.394524     -0.043436      0.020067      0.168867
2010-01-19 -0.414642 -0.953271 -1.497235     -0.125190     -0.161451     -0.123043
2010-01-20 -0.430467 -0.845109 -1.383738     -0.222437     -0.360846     -0.431062
2010-01-21 -0.566189 -0.996656 -1.411298     -0.253410     -0.437522     -0.565034
2010-01-22 -0.763102 -1.329291 -1.759758     -0.230250     -0.411571     -0.550629
2010-01-23 -0.806448 -1.569550 -2.135739     -0.201312     -0.365467     -0.498217
2010-01-24 -0.910455 -1.716903 -2.480005     -0.134063     -0.242195     -0.331187
2010-01-25 -0.987985 -1.898440 -2.704888      0.341146      0.603872      0.817081
2010-01-26 -1.010479 -1.998463 -2.908919     -0.335480     -0.458324     -0.497143
2010-01-27 -1.099712 -2.110191 -3.098175     -0.954718     -1.543042     -1.937214
2010-01-28 -1.189052 -2.288764 -3.299243     -1.368599     -2.360791     -3.104164
2010-01-29 -1.063995 -2.253047 -3.352759     -1.566175     -2.838536     -3.862305
2010-01-30 -0.880117 -1.944112 -3.133164     -1.689508     -3.184460     -4.455993
2010-01-31 -0.987238 -1.867354 -2.931349     -1.770377     -3.440694     -4.927217
2010-02-01 -1.010754 -1.997992 -2.878109     -1.674184     -3.355100     -4.917760
2010-02-02 -1.050584 -2.061338 -3.048576     -1.458053     -3.014790     -4.526260
2010-02-03 -1.151782 -2.202366 -3.213120     -1.370453     -2.872802     -4.375345
2010-02-04 -1.326863 -2.478645 -3.529229     -1.313724     -2.770772     -4.260684
2010-02-05 -1.655648 -2.982511 -4.134293     -1.288496     -2.717152     -4.199991
2010-02-06 -1.768781 -3.424429 -4.751292     -1.318855     -2.761046     -4.266718
2010-02-07 -1.675248 -3.444029 -5.099677     -1.425470     -2.945282     -4.526140
2010-02-08 -1.584265 -3.259513 -5.028293     -1.668319     -3.383164     -5.141021
2010-02-09 -1.578693 -3.162957 -4.838205     -1.870139     -3.764681     -5.692228
2010-02-10 -1.620368 -3.199060 -4.783325     -1.924164     -3.890089     -5.898239
2010-02-11 -1.798330 -3.418698 -4.997391     -1.890999     -3.853091     -5.875012
2010-02-12 -2.018167 -3.816497 -5.436865     -1.854886     -3.799253     -5.817544
2010-02-13 -2.136215 -4.154382 -5.952713     -1.844402     -3.782890     -5.802731
2010-02-14 -2.076567 -4.212782 -6.230949     -1.922922     -3.922162     -5.997303
2010-02-15 -1.936493 -4.013060 -6.149275     -2.078835     -4.204549     -6.391695
2010-02-16 -2.078435 -4.014928 -6.091495     -2.227438     -4.483790     -6.790161
2010-02-17       NaN       NaN       NaN     -2.275451     -4.590063     -6.957308
2010-02-18       NaN       NaN       NaN     -2.220871     -4.509492     -6.865022
2010-02-19       NaN       NaN       NaN     -2.251846     -4.570485     -6.956943
